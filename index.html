<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BoostVerseTG Shop</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .gradient-text {
            background-image: linear-gradient(to right, var(--tw-gradient-stops));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
        }
        .page-container {
            max-width: 420px;
            margin: auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 font-sans">

<div class="page-container p-4">
    <!-- Header -->
    <header class="py-6 mb-8 border-b border-purple-700/50">
        <h1 class="text-4xl font-extrabold text-center">
            <span class="gradient-text from-indigo-400 via-purple-400 to-pink-400">
                BoostVerseTG Shop
            </span>
        </h1>
        <p class="text-center text-sm text-gray-400 mt-1">
            Digital & Design Services for the Modern Creator
        </p>
    </header>

    <!-- Main -->
    <main id="app-content" class="flex-grow"></main>

    <!-- Footer -->
    <footer class="mt-8 pt-4 border-t border-purple-700/50">
        <div class="space-y-3">
            <button onclick="navigate('home')"
                    class="w-full bg-purple-700 hover:bg-purple-600 transition duration-150 text-white font-semibold py-3 rounded-xl shadow-lg shadow-purple-900/50">
                &larr; Back to Home
            </button>
            <button onclick="navigate('admin')"
                    class="w-full bg-gray-800 hover:bg-gray-700 transition duration-150 text-purple-200 font-semibold py-3 rounded-xl border border-purple-600 shadow-lg shadow-purple-900/40 text-sm">
                üîê Admin / Orders Panel
            </button>
            <button onclick="navigate('track-order')"
                    class="w-full bg-green-700 hover:bg-green-600 transition duration-150 text-white font-semibold py-3 rounded-xl shadow-lg shadow-green-900/40 text-sm">
                üìå Track Order Status
            </button>
        </div>
    </footer>

    <!-- Toast -->
    <div id="toast"
         class="fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-gray-700 text-white px-4 py-2 rounded-lg shadow-xl opacity-0 transition-opacity duration-300"></div>
</div>

<script>
    // --- Config / Data ---
    const UPI_ID = "lavyanshboss@fam";

    const ADMIN_USERNAME = "nexonrandxbeta";
    const ADMIN_PASSWORD = "madarapapa";

    let ORDERS = [];

    const CATEGORIES = {
        'A': { title: 'üåê Digital Products', description: 'Websites, Bio Links, and Custom Pages.' },
        'B': { title: 'üé® Design Services', description: 'Logos, Banners, and Visual Branding.' },
        'C': { title: 'üéÆ Gaming-Related', description: 'Sensitivity, Keybinds, and Video Edits (Legal Services Only).' },
        'D': { title: '‚ö° Custom Services', description: 'Full Branding, Bulk Orders, and Bespoke Projects.' }
    };

    const SERVICES = {
        // Category A: Digital Products
        'web-bio-link': { cat: 'A', name: 'Webpage / Bio Link Website', price: '‚Çπ149 ‚Äì ‚Çπ399' },
        'full-template': { cat: 'A', name: 'Full Website Template', price: '‚Çπ299 ‚Äì ‚Çπ799' },
        'portfolio-business': { cat: 'A', name: 'Portfolio / Business Page', price: '‚Çπ199 ‚Äì ‚Çπ499' },
        'custom-landing': { cat: 'A', name: 'Custom Landing Page', price: '‚Çπ399 ‚Äì ‚Çπ999' },

        // Category B: Design Services
        'gaming-logo': { cat: 'B', name: 'Gaming Logo', price: '‚Çπ99 ‚Äì ‚Çπ249' },
        'professional-logo': { cat: 'B', name: 'Professional Logo', price: '‚Çπ149 ‚Äì ‚Çπ399' },
        'youtube-thumbnail': { cat: 'B', name: 'YouTube Thumbnail', price: '‚Çπ49 ‚Äì ‚Çπ99' },
        'instagram-banner': { cat: 'B', name: 'Instagram Banner', price: '‚Çπ79 ‚Äì ‚Çπ149' },
        'telegram-banner': {
            cat: 'B',
            name: 'Telegram Channel Banner',
            price: '‚Çπ69 ‚Äì ‚Çπ149',
            variants: [
                '1. Modern Telegram Channel Banner',
                '2. Gaming Style Banner',
                '3. Business/Professional Banner',
                '4. Futuristic / Sci-Fi Banner',
                '5. Minimal Aesthetic Banner',
                '6. Digital Shop Banner'
            ]
        },

        // Category C: Gaming-Related
        'sensitivity-setup': { cat: 'C', name: 'Sensitivity Settings Setup', price: '‚Çπ49 ‚Äì ‚Çπ99' },
        'keybind-layout': { cat: 'C', name: 'Keybind Layout Design', price: '‚Çπ59 ‚Äì ‚Çπ129' },
        'game-thumbnail': { cat: 'C', name: 'Game Thumbnail / Cover', price: '‚Çπ49 ‚Äì ‚Çπ149' },
        'gaming-montage': { cat: 'C', name: 'Gaming Montage Edit', price: '‚Çπ149 ‚Äì ‚Çπ499' },

        // Category D: Custom Services
        'custom-service': { cat: 'D', name: 'Custom Services (Website/Graphic Pack/Branding/Bulk)', price: '‚Çπ199 ‚Äì ‚Çπ1999 (According to work)' }
    };

    const appContent = document.getElementById('app-content');

    // --- Utils ---
    function showToast(message) {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.classList.add('opacity-100');
        setTimeout(() => toast.classList.remove('opacity-100'), 3000);
    }

    function copyUpiId() {
        const upiId = UPI_ID;
        const tempInput = document.createElement('input');
        tempInput.value = upiId;
        document.body.appendChild(tempInput);
        tempInput.select();
        try {
            document.execCommand('copy');
            showToast(`‚úÖ Copied UPI ID: ${upiId}`);
        } catch (err) {
            console.error('Failed to copy text: ', err);
            showToast('‚ùå Copy failed. Please copy manually.');
        } finally {
            document.body.removeChild(tempInput);
        }
    }

    function copyOrderId(orderId) {
        try {
            navigator.clipboard.writeText(orderId);
            showToast("üìã Order ID copied!");
        } catch (e) {
            const tempInput = document.createElement('input');
            tempInput.value = orderId;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);
            showToast("üìã Order ID copied!");
        }
    }

    function fileToBase64(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.onerror = (err) => reject(err);
            reader.readAsDataURL(file);
        });
    }

    // --- LocalStorage - Orders ---
    function loadOrders() {
        try {
            const raw = localStorage.getItem('boostverse_orders');
            ORDERS = raw ? JSON.parse(raw) : [];
        } catch (e) {
            console.error('Failed to load orders from localStorage:', e);
            ORDERS = [];
        }
    }

    function saveOrders() {
        try {
            localStorage.setItem('boostverse_orders', JSON.stringify(ORDERS));
        } catch (e) {
            console.error('Failed to save orders to localStorage:', e);
        }
    }

    // --- Admin Auth ---
    function isAdminLoggedIn() {
        return sessionStorage.getItem('isAdmin') === 'true';
    }

    function logoutAdmin() {
        sessionStorage.removeItem('isAdmin');
        showToast('Logged out from Admin panel.');
        renderAdminLogin();
    }

    // --- Router ---
    function navigate(path) {
        window.location.hash = path;
        renderPage();
    }

    function getPathSegments() {
        const hash = window.location.hash.slice(1);
        if (!hash || hash === 'home') return { page: 'home' };
        const parts = hash.split('/');
        return { page: parts[0], id: parts[1] };
    }

    function renderPage() {
        const { page, id } = getPathSegments();
        appContent.innerHTML = '';

        if (page === 'service' && id && SERVICES[id]) {
            renderServiceDetail(id);
        } else if (page === 'category' && CATEGORIES[id]) {
            renderCategoryList(id);
        } else if (page === 'admin') {
            renderAdminPage();
        } else if (page === 'track-order') {
            renderTrackOrderPage();
        } else {
            renderHome();
        }
    }

    // --- Pages ---

    // Home
    function renderHome() {
        let html = `
            <section class="space-y-6">
                <h2 class="text-2xl font-bold text-center mb-6 text-purple-300">Our Service Categories</h2>
        `;

        Object.keys(CATEGORIES).forEach(catId => {
            const cat = CATEGORIES[catId];
            html += `
                <div onclick="navigate('category/${catId}')"
                     class="bg-gray-800 p-5 rounded-xl border border-gray-700 hover:border-indigo-500 transition duration-200 cursor-pointer shadow-xl shadow-gray-900/50">
                    <h3 class="text-xl font-semibold text-white mb-1 flex items-center">
                        <span class="mr-3 text-2xl text-pink-400">${catId}</span>
                        ${cat.title}
                    </h3>
                    <p class="text-sm text-gray-400">${cat.description}</p>
                </div>
            `;
        });

        html += `
            <button onclick="navigate('track-order')"
                    class="mt-8 w-full bg-green-600 hover:bg-green-500 text-white font-semibold py-3 rounded-xl shadow-lg shadow-green-900/50">
                üìå Track Your Order Status
            </button>
        `;

        html += `</section>`;
        appContent.innerHTML = html;
    }

    // Track Order Page
    function renderTrackOrderPage() {
        const html = `
            <section class="space-y-4 bg-gray-800 p-6 rounded-xl shadow-2xl shadow-gray-900/70">
                <h2 class="text-2xl font-bold text-white mb-2">Track Order</h2>
                <p class="text-sm text-gray-400 mb-4">
                    Enter your Order ID to check your order status.
                    (Example: <span class="font-mono text-green-400">BV123456</span>)
                </p>

                <input id="track-id" type="text"
                       class="w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:ring-purple-500 focus:border-purple-500"
                       placeholder="Enter your Order ID">

                <button onclick="trackOrder()"
                        class="w-full bg-purple-600 hover:bg-purple-500 text-white font-bold py-3 rounded-lg transition duration-150 shadow-md shadow-purple-900/40">
                    üîç Check Status
                </button>

                <div id="track-result"
                     class="hidden mt-5 p-4 rounded-lg bg-gray-900 border border-gray-700 text-sm text-gray-100"></div>

                <button onclick="navigate('home')"
                        class="mt-4 text-purple-400 hover:text-purple-300 flex items-center text-sm">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                         xmlns="http://www.w3.org/2000/svg">
                         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                               d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                    Back to Shop
                </button>
            </section>
        `;
        appContent.innerHTML = html;
    }

    function trackOrder() {
        const input = document.getElementById('track-id');
        const resultBox = document.getElementById('track-result');
        const id = input.value.trim();

        if (!id) {
            resultBox.classList.remove('hidden');
            resultBox.innerHTML = `<p class="text-red-400">‚ùå Please enter a valid Order ID.</p>`;
            return;
        }

        const order = ORDERS.find(o => String(o.id) === id);

        if (!order) {
            resultBox.classList.remove('hidden');
            resultBox.innerHTML = `
                <p class="text-red-400 font-semibold mb-1">‚ùå Order not found.</p>
                <p class="text-gray-300 text-xs">
                    Please check your Order ID. Make sure you typed it exactly as shown when the order was placed.
                </p>
            `;
            return;
        }

        const createdAt = new Date(order.createdAt);
        const createdStr = isNaN(createdAt.getTime()) ? order.createdAt : createdAt.toLocaleString();

        resultBox.classList.remove('hidden');
        resultBox.innerHTML = `
            <p class="text-xs text-gray-400 mb-1">Order ID:
                <span class="font-mono text-green-400">${order.id}</span>
            </p>
            <p><span class="font-semibold">Service:</span> ${order.serviceName}</p>
            <p><span class="font-semibold">Status:</span> <span class="text-indigo-300">${order.status}</span></p>
            <p><span class="font-semibold">Placed On:</span> ${createdStr}</p>
            <p class="mt-2 text-xs text-gray-400">
                If you need help, contact us and mention this Order ID.
            </p>
        `;
    }

    // Category List
    function renderCategoryList(catId) {
        const category = CATEGORIES[catId];
        let html = `
            <section>
                <h2 class="text-3xl font-bold mb-2 text-white">${category.title}</h2>
                <p class="text-gray-400 mb-6">${category.description}</p>
                <div class="space-y-4">
        `;

        Object.keys(SERVICES)
            .filter(key => SERVICES[key].cat === catId)
            .forEach(serviceId => {
                const service = SERVICES[serviceId];
                html += `
                    <div onclick="navigate('service/${serviceId}')"
                         class="bg-gray-800 p-4 rounded-lg border-l-4 border-purple-500 hover:bg-gray-700/50 transition duration-200 cursor-pointer shadow-md">
                        <h4 class="text-lg font-medium text-white">${service.name}</h4>
                        <p class="text-sm font-semibold text-pink-400 mt-1">${service.price}</p>
                    </div>
                `;
            });

        html += `
                </div>
                <button onclick="navigate('home')"
                        class="mt-8 text-purple-400 hover:text-purple-300 flex items-center">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                         xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                    Back to Categories
                </button>
            </section>
        `;
        appContent.innerHTML = html;
    }

    // Service Detail + Order Form
    function renderServiceDetail(serviceId) {
        const service = SERVICES[serviceId];
        const category = CATEGORIES[service.cat];

        let variantsHtml = '';
        if (service.variants) {
            variantsHtml = `
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-300 mb-2">
                        Design Options (Choose one or specify below)
                    </label>
                    <select id="variant-select"
                            class="w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-purple-500 focus:border-purple-500">
                        <option value="">-- Select Design Type (If applicable) --</option>
                        ${service.variants.map(v => `<option value="${v}">${v}</option>`).join('')}
                    </select>
                </div>
            `;
        }

        const html = `
            <section>
                <h2 class="text-3xl font-bold mb-1 text-white">${service.name}</h2>
                <p class="text-purple-400 mb-6 text-lg font-extrabold">${service.price}</p>

                <form id="order-form" data-service-id="${serviceId}"
                      class="space-y-6 bg-gray-800 p-6 rounded-xl shadow-2xl shadow-gray-900/70">
                    <h3 class="text-xl font-semibold text-white border-b border-gray-700 pb-3">
                        1. Contact & Service Details
                    </h3>

                    <div>
                        <label for="contact-name"
                               class="block text-sm font-medium text-gray-300 mb-2">
                            Your Name / Telegram ID
                        </label>
                        <input type="text" id="contact-name" name="contact-name" required
                               class="w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:ring-purple-500 focus:border-purple-500"
                               placeholder="e.g., @BoostVerseTG or Your Name">
                    </div>

                    <div>
                        <label for="contact-email"
                               class="block text-sm font-medium text-gray-300 mb-2">
                            Your Email (for communication)
                        </label>
                        <input type="email" id="contact-email" name="contact-email" required
                               class="w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:ring-purple-500 focus:border-purple-500"
                               placeholder="yourname@example.com">
                    </div>

                    ${variantsHtml}

                    <div>
                        <label for="description"
                               class="block text-sm font-medium text-gray-300 mb-2">
                            Project Description/Requirements
                        </label>
                        <textarea id="description" name="description" rows="4" required
                                  class="w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:ring-purple-500 focus:border-purple-500"
                                  placeholder="Describe exactly what you need (colors, style, content, etc.)"></textarea>
                    </div>

                    <h3 class="text-xl font-semibold text-white border-b border-gray-700 pb-3">
                        2. Payment & Proof
                    </h3>

                    <div class="bg-gray-700 p-4 rounded-lg border border-yellow-500/50">
                        <p class="text-yellow-400 text-base font-bold mb-2">
                            üí∞ Step 1: Complete Payment (Simulation)
                        </p>
                        <p class="text-sm text-gray-300 mb-3">
                            Please send the required payment amount (within the range above) to the following UPI ID:
                        </p>

                        <div class="bg-gray-900 p-3 rounded-lg flex justify-between items-center mb-4 border border-purple-500">
                            <span id="upi-id-display"
                                  class="text-lg font-mono text-green-400 tracking-wider break-all">
                                ${UPI_ID}
                            </span>
                            <button type="button" onclick="copyUpiId()" title="Copy UPI ID"
                                    class="ml-3 flex-shrink-0 text-sm text-purple-300 hover:text-purple-100 p-1 rounded transition duration-150">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1.5m-4-11l1.5-1.5m0 0l1.5 1.5m-1.5-1.5V17"></path>
                                </svg>
                            </button>
                        </div>

                        <p class="text-sm text-gray-300">
                            ‚ö†Ô∏è <strong>Step 2: Confirmation.</strong>
                            Once payment is done, click the button below to confirm and enable the screenshot upload field.
                        </p>
                    </div>

                    <button type="button" onclick="showPaymentConfirmation()"
                            class="w-full bg-green-600 hover:bg-green-500 text-white font-bold py-3 rounded-lg transition duration-150 shadow-md shadow-green-900/50">
                        Simulate Payment Done / Get Screenshot Link
                    </button>

                    <div id="payment-status"
                         class="hidden text-center text-green-400 font-bold p-3 bg-gray-700 rounded-lg">
                        ‚úÖ Payment Confirmed! Please upload your screenshot below.
                    </div>

                    <!-- UTR / Transaction Number (shown after payment confirm) -->
                    <div id="utr-block" class="hidden">
                        <label class="block text-sm font-medium text-gray-300 mb-2">
                            UTR / Transaction Number
                        </label>
                        <input type="text" id="utr-number"
                               class="w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:ring-purple-500 focus:border-purple-500"
                               placeholder="Example: 2233445566A or UPI Ref No.">
                        <p class="text-xs text-gray-500 mt-1">
                            Enter the UPI reference / UTR number from your payment.
                        </p>
                    </div>

                    <div>
                        <label for="screenshot"
                               class="block text-sm font-medium text-gray-300 mb-2">
                            Payment Screenshot Proof
                        </label>
                        <input type="file" id="screenshot" name="screenshot" accept="image/*" disabled
                               class="w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-purple-500 file:text-white hover:file:bg-purple-600">
                        <p class="text-xs text-gray-500 mt-1">
                            Screenshot yahi browser me save hoga, server pe upload nahi hota.
                        </p>
                    </div>

                    <button type="submit"
                            class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-extrabold text-xl py-4 rounded-xl transition duration-150 shadow-lg shadow-indigo-900/50">
                        Submit Order
                    </button>
                </form>

                <div id="confirmation-message"
                     class="hidden mt-6 p-4 bg-teal-800/50 border-l-4 border-teal-500 rounded-lg text-white">
                </div>

                <button onclick="navigate('category/${service.cat}')"
                        class="mt-8 text-purple-400 hover:text-purple-300 flex items-center">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                         xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                    Back to ${category.title}
                </button>
            </section>
        `;
        appContent.innerHTML = html;

        document.getElementById('order-form').addEventListener('submit', handleOrderSubmission);
    }

    // --- Admin Pages ---
    function renderAdminPage() {
        if (isAdminLoggedIn()) {
            renderAdminDashboard();
        } else {
            renderAdminLogin();
        }
    }

    function renderAdminLogin() {
        const html = `
            <section class="max-w-md mx-auto bg-gray-800 p-6 rounded-2xl shadow-2xl shadow-gray-900/70">
                <h2 class="text-2xl font-bold text-white mb-2 text-center">Admin Login</h2>
                <p class="text-xs text-gray-400 mb-4 text-center">
                    Only for owner access to view & manage orders.
                </p>
                <form id="admin-login-form" class="space-y-4">
                    <div>
                        <label class="block text-sm text-gray-300 mb-1" for="admin-username">Username</label>
                        <input id="admin-username" type="text" required
                               class="w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:ring-purple-500 focus:border-purple-500"
                               placeholder="Admin username">
                    </div>
                    <div>
                        <label class="block text-sm text-gray-300 mb-1" for="admin-password">Password</label>
                        <input id="admin-password" type="password" required
                               class="w-full p-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:ring-purple-500 focus:border-purple-500"
                               placeholder="Admin password">
                    </div>
                    <p id="admin-error" class="hidden text-sm text-red-400"></p>
                    <button type="submit"
                            class="w-full bg-purple-700 hover:bg-purple-600 transition duration-150 text-white font-semibold py-3 rounded-xl shadow-lg shadow-purple-900/50">
                        Login
                    </button>
                </form>
            </section>
        `;
        appContent.innerHTML = html;
        document.getElementById('admin-login-form').addEventListener('submit', handleAdminLogin);
    }

    function handleAdminLogin(e) {
        e.preventDefault();
        const username = document.getElementById('admin-username').value.trim();
        const password = document.getElementById('admin-password').value.trim();
        const errorEl = document.getElementById('admin-error');

        if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
            sessionStorage.setItem('isAdmin', 'true');
            errorEl.classList.add('hidden');
            showToast('‚úÖ Admin login successful');
            renderAdminDashboard();
        } else {
            errorEl.textContent = '‚ùå Invalid username or password.';
            errorEl.classList.remove('hidden');
        }
    }

    function renderAdminDashboard() {
        let html = `
            <section>
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h2 class="text-2xl font-bold text-white">Orders Dashboard</h2>
                        <p class="text-xs text-gray-400">
                            Showing orders saved in this browser (localStorage).
                        </p>
                    </div>
                    <button onclick="logoutAdmin()"
                            class="text-xs px-3 py-1 rounded-full bg-red-600 hover:bg-red-500 text-white font-semibold">
                        Logout
                    </button>
                </div>
        `;

        if (!ORDERS || ORDERS.length === 0) {
            html += `
                <div class="mt-6 p-4 bg-gray-800 rounded-xl border border-gray-700 text-center">
                    <p class="text-gray-300 text-sm">
                        No orders found yet. Ask customers to place an order from the shop page.
                    </p>
                </div>
            `;
        } else {
            html += `<div class="space-y-4">`;
            ORDERS.forEach(order => {
                const createdAt = new Date(order.createdAt);
                const createdStr = isNaN(createdAt.getTime()) ? order.createdAt : createdAt.toLocaleString();
                html += `
                    <div class="bg-gray-800 p-4 rounded-xl border border-gray-700 shadow-lg shadow-gray-900/60">
                        <div class="flex items-center justify-between mb-1">
                            <span class="text-xs text-gray-400">
                                Order ID: <span class="font-mono text-green-400">${order.id}</span>
                            </span>
                            <span class="text-xs text-gray-500">${createdStr}</span>
                        </div>
                        <h3 class="text-lg font-semibold text-white">${order.serviceName}</h3>
                        <p class="text-sm text-pink-400 mb-1">${order.priceRange || ''}</p>
                        <p class="text-xs text-gray-400 mb-2">${order.category || ''}</p>

                        <p class="text-sm text-gray-300">
                            <span class="font-semibold">Client:</span> ${order.contactName || 'N/A'}
                            <span class="text-xs text-gray-400">(${order.contactEmail || 'N/A'})</span>
                        </p>
                        <p class="text-sm text-gray-300 mt-1">
                            <span class="font-semibold">Variant:</span> ${order.variant || 'N/A'}
                        </p>
                        <p class="text-sm text-gray-300 mt-1">
                            <span class="font-semibold">Requirements:</span> ${order.requirements || 'N/A'}
                        </p>
                        <p class="text-sm text-gray-300 mt-1">
                            <span class="font-semibold">UTR Number:</span> ${order.utrNumber || 'N/A'}
                        </p>
                        <p class="text-xs text-gray-400 mt-1">
                            <span class="font-semibold">Payment Proof:</span>
                            ${order.screenshotInfo || (order.paymentProof ? 'Screenshot saved' : 'No screenshot')}
                        </p>

                        ${order.paymentProof ? `
                            <button class="mt-2 bg-indigo-600 hover:bg-indigo-500 text-white text-xs font-semibold px-3 py-1 rounded"
                                    onclick="viewScreenshot('${order.id}')">
                                üì∑ View Screenshot
                            </button>
                        ` : ``}

                        <div class="mt-3 flex items-center justify-between">
                            <div class="flex items-center space-x-2">
                                <span class="text-xs text-gray-400">Status:</span>
                                <select onchange="updateOrderStatus('${order.id}', this.value)"
                                        class="text-xs bg-gray-900 border border-gray-600 rounded px-2 py-1 text-white focus:ring-purple-500 focus:border-purple-500">
                                    <option value="Pending" ${order.status === 'Pending' ? 'selected' : ''}>Pending</option>
                                    <option value="In Progress" ${order.status === 'In Progress' ? 'selected' : ''}>In Progress</option>
                                    <option value="Completed" ${order.status === 'Completed' ? 'selected' : ''}>Completed</option>
                                    <option value="Cancelled" ${order.status === 'Cancelled' ? 'selected' : ''}>Cancelled</option>
                                </select>
                            </div>
                            <span class="text-[10px] px-2 py-1 rounded-full border border-gray-600 text-gray-300">
                                UPI: ${UPI_ID}
                            </span>
                        </div>
                    </div>
                `;
            });
            html += `</div>`;
        }

        html += `
                <button onclick="navigate('home')"
                        class="mt-8 text-purple-400 hover:text-purple-300 flex items-center text-sm">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                         xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                    Back to Shop
                </button>
            </section>
        `;
        appContent.innerHTML = html;
    }

    function updateOrderStatus(orderId, newStatus) {
        const idx = ORDERS.findIndex(o => String(o.id) === String(orderId));
        if (idx !== -1) {
            ORDERS[idx].status = newStatus;
            saveOrders();
            showToast(`Order ${orderId} status: ${newStatus}`);
        }
    }

    function viewScreenshot(orderId) {
        const order = ORDERS.find(o => String(o.id) === String(orderId));
        if (!order || !order.paymentProof) {
            showToast("‚ùå No screenshot saved for this order.");
            return;
        }
        const win = window.open("", "_blank");
        win.document.write(`
            <html>
                <head><title>Payment Screenshot - ${order.id}</title></head>
                <body style="margin:0; background:#000; display:flex; align-items:center; justify-content:center; height:100vh;">
                    <img src="${order.paymentProof}" style="max-width:100%; max-height:100%; border-radius:10px;" />
                </body>
            </html>
        `);
        win.document.close();
    }

    // --- Payment confirm / UTR show ---
    function showPaymentConfirmation() {
        const statusDiv = document.getElementById('payment-status');
        const screenshotInput = document.getElementById('screenshot');
        const utrBlock = document.getElementById('utr-block');

        statusDiv.classList.remove('hidden');
        screenshotInput.disabled = false;
        if (utrBlock) utrBlock.classList.remove('hidden');
    }

    // --- Order submission ---
    async function handleOrderSubmission(event) {
        event.preventDefault();
        const form = event.target;
        const serviceId = form.getAttribute('data-service-id');
        const service = SERVICES[serviceId];

        const contactName = document.getElementById('contact-name').value.trim();
        const contactEmail = document.getElementById('contact-email').value.trim();
        const description = document.getElementById('description').value.trim();
        const screenshotFile = document.getElementById('screenshot').files[0];
        const variantSelect = document.getElementById('variant-select');
        const variant = variantSelect ? variantSelect.value : 'N/A';

        const paymentStatus = document.getElementById('payment-status');
        const utrInput = document.getElementById('utr-number');
        const utrNumber = utrInput ? utrInput.value.trim() : '';

        const confirmationMessage = document.getElementById('confirmation-message');

        if (paymentStatus.classList.contains('hidden')) {
            showToast('‚õî Please confirm payment first.');
            return;
        }

        if (!utrNumber) {
            showToast('‚ö†Ô∏è Please enter your UTR / Transaction number.');
            return;
        }

        // Generate Order ID
        const orderId = "BV" + Math.floor(100000 + Math.random() * 900000);

        // Screenshot to Base64
        let screenshotBase64 = "";
        let screenshotInfo = "No screenshot uploaded";
        if (screenshotFile) {
            try {
                screenshotBase64 = await fileToBase64(screenshotFile);
                screenshotInfo = `${screenshotFile.name} (${screenshotFile.size} bytes)`;
            } catch (e) {
                console.error("Error converting screenshot:", e);
            }
        }

        const newOrder = {
            id: orderId,
            createdAt: new Date().toISOString(),
            serviceId: serviceId,
            serviceName: service.name,
            category: CATEGORIES[service.cat].title,
            priceRange: service.price,
            variant: variant,
            contactName: contactName,
            contactEmail: contactEmail,
            requirements: description,
            paymentProof: screenshotBase64,
            screenshotInfo: screenshotInfo,
            upiIdUsed: UPI_ID,
            utrNumber: utrNumber,
            status: 'Pending'
        };

        ORDERS.unshift(newOrder);
        saveOrders();

        form.classList.add('hidden');
        confirmationMessage.classList.remove('hidden');
        confirmationMessage.innerHTML = `
            <h4 class="font-bold text-lg mb-2">üéâ Order Placed Successfully!</h4>
            <p class="mb-2">Thank you! Your order has been submitted and saved.</p>
            <p class="text-sm">Your Order ID:</p>
            <div class="bg-black/30 p-3 rounded-lg mt-2 mb-3 font-mono text-green-400 text-lg tracking-wider break-all">
                ${orderId}
            </div>
            <button onclick="copyOrderId('${orderId}')"
                    class="bg-purple-600 hover:bg-purple-500 text-white text-sm font-semibold px-3 py-2 rounded-lg mb-2">
                üìã Copy Order ID
            </button>
            <p class="text-xs text-gray-300 mt-1">
                Save this Order ID safely. You can use it anytime on the <strong>Track Order</strong> page to check your order status.
            </p>
            <button onclick="navigate('track-order')"
                    class="mt-4 bg-green-600 hover:bg-green-500 text-white py-2 px-4 rounded-lg w-full text-sm font-semibold">
                üìå Go to Track Order
            </button>
        `;

        showToast('‚úÖ Order placed & saved. Screenshot & UTR admin panel se dekhe ja sakte hain.');
    }

    // --- Init ---
    window.addEventListener('hashchange', renderPage);
    window.addEventListener('load', () => {
        loadOrders();
        renderPage();
    });
</script>
</body>
</html>